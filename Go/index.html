<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>WebSocket Chat</title>
<style>
body { font-family: Arial; background:#f2f2f2 }
#chat { height:300px; overflow:auto; background:white; padding:10px }
.system { color:#888; text-align:center; margin:5px }
.me { color:blue }
.other { color:green }
</style>
</head>
<body>

<h2>ğŸŸ¢ ÄÃ£ káº¿t ná»‘i</h2>
<p>ğŸ‘¥ Online: <span id="count">0</span></p>

<div id="chat"></div>
<input id="msg" placeholder="Nháº­p tin nháº¯n">
<button onclick="send()">Gá»­i</button>

<script>
const ws = new WebSocket("ws://localhost:8080/ws");
const chat = document.getElementById("chat");

const username = prompt("Nháº­p tÃªn cá»§a báº¡n:");

ws.onopen = () => {
  ws.send(JSON.stringify({ type:"join", username }));
};

ws.onmessage = e => {
  const m = JSON.parse(e.data);

  if (m.type === "join")
    add(`ğŸ”” ${m.username} Ä‘Ã£ tham gia phÃ²ng chat!`, "system");

  if (m.type === "leave")
    add(`âŒ ${m.username} Ä‘Ã£ rá»i phÃ²ng chat!`, "system");

  if (m.type === "count")
    document.getElementById("count").innerText = m.count;

  if (m.type === "chat") {
    const cls = m.username === username ? "me" : "other";
    add(`${m.username}: ${m.content}`, cls);

  }
};

function send() {
  const input = document.getElementById("msg");
  ws.send(JSON.stringify({
    type: "chat",
    username,
    content: input.value
  }));
  input.value = "";
}

function add(text, cls) {
  const div = document.createElement("div");
  div.className = cls;
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>
